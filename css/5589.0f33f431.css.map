{"version":3,"file":"css/5589.0f33f431.css","mappings":";AAkJC;EACC,iBAAiB;EACjB,eAAe;EACf,kBAAkB;EAClB,oBAAoB;AACrB;AACA;EACC,mBAAmB;EACnB,eAAe;EACf,kBAAkB;EAClB,mBAAmB;AACpB","sources":["webpack://erp/./src/pages/index/verifyotp.vue"],"sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <div class=\"row justify-center\">\r\n            <div class=\"col-md-5 col-12\">\r\n                <q-card class=\"q-my-lg no-shadow\">\r\n\t\t\t\t\t<q-card-section>\r\n\t\t\t\t\t\t<q-banner>\r\n\t\t\t\t\t\t\t<template v-slot:avatar>\r\n\t\t\t\t\t\t\t\t<q-icon color=\"positive\" size=\"40px\" name=\"check_circle\"></q-icon>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<div class=\"row justify-between q-col-gutter-md\">\r\n\t\t\t\t\t\t\t\t<div class=\"col\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"text-h6 text-bold\">{{ $t('otpVerification') }}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"text-h6 text-bold text-info\">{{ countDown }}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"text-body2 text-grey-6\">{{ $t('otpSentSMS') }}</div>\r\n\t\t\t\t\t\t</q-banner>\r\n\t\t\t\t\t\t<q-form ref=\"observer\" @submit.prevent=\"startOtpValidation()\" >\r\n\t\t\t\t\t\t\t<div class=\"row justify-between q-col-gutter-md\">\r\n\t\t\t\t\t\t\t\t<div class=\"col\">\r\n\t\t\t\t\t\t\t\t\t<q-input dense class=\"text-center\" outlined :placeholder=\"$t('enterOtp')\" v-model=\"otpCode\" required=\"required\" type=\"text\" input-class=\"text-center text-left otp-input\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n\t\t\t\t\t\t\t\t\t<q-btn unelevated :loading=\"loading\" color=\"positive\" no-caps type=\"submit\">\r\n\t\t\t\t\t\t\t\t\t\t\t{{ $t('verify') }}\r\n\t\t\t\t\t\t\t\t\t</q-btn>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<transition appear enter-active-class=\"animated bounceIn\" leave-active-class=\"animated fadeOut\" >\r\n\t\t\t\t\t\t\t\t<q-banner dense inline-actions rounded class=\"bg-red-1\" v-if=\"errorMsg\">\r\n\t\t\t\t\t\t\t\t\t<template v-slot:avatar>\r\n\t\t\t\t\t\t\t\t\t\t<q-icon color=\"red\" name=\"error\" />\r\n\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t{{ errorMsg.toString() }}\r\n\t\t\t\t\t\t\t\t\t<template v-slot:action>\r\n\t\t\t\t\t\t\t\t\t\t<q-btn @click=\"errorMsg = null\" dense flat icon=\"close\" />\r\n\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t</q-banner>\r\n\t\t\t\t\t\t\t</transition>\r\n\t\t\t\t\t\t\t<div class=\"row justify-between q-col-gutter-md q-mt-xs\">\r\n\t\t\t\t\t\t\t\t<div class=\"col\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text-grey\">Didn't receive OTP</span> ? \r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"col-auto\">\r\n\t\t\t\t\t\t\t\t\t<q-btn unelevated color=\"blue-1\"  text-color=\"blue\" :disabled=\"!canResend\" :loading=\"resending\" @click=\"resendOtp()\" no-caps type=\"button\">\r\n\t\t\t\t\t\t\t\t\t\tResend...\r\n\t\t\t\t\t\t\t\t\t</q-btn>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</q-form>\r\n\t\t\t\t\t</q-card-section>\r\n                </q-card>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { useAuthStore } from 'src/stores/auth';\r\nexport default {\r\n    setup() {\r\n\t\t\tconst store = useAuthStore()\r\n\t\t\treturn { store }\r\n\t\t},\r\n\tdata: function () {\r\n        return {\r\n\t\t\totpCode: '',\r\n            loading: false,\r\n            resending: false,\r\n            canResend: false,\r\n            errorMsg: '',\r\n            countDown: '00:00',\r\n        };\r\n    },\r\n    methods: {\r\n        async startOtpValidation() {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.errorMsg = '';\r\n\t\t\tlet formData = { otp_code: this.otpCode, token: this.$route.query.token }\r\n\t\t\tlet rememberUser = false;\r\n\t\t\tlet url = \"/auth/validateotp\";\r\n\t\t\tlet payload = { formData, rememberUser, url };\r\n\t\t\ttry{\r\n\t\t\t\tconst loginData = await this.store.login(payload);\r\n\t\t\t\tif (loginData.token) {\r\n\t\t\t\t\twindow.location = \"/\"; //user is now logged in. Navigate to home page\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis.$router.push(loginData.nextpage);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch(request){\r\n\t\t\t\tthis.errorMsg = request?.response?.data || \"Unable to validate otp\";\r\n\t\t\t}\r\n\t\t\tfinally{\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t}\r\n        },\r\n        async resendOtp() {\r\n            this.resending = true;\r\n\t\t\tthis.errorMsg = '';\r\n\t\t\tlet formData = {\r\n\t\t\t\ttoken:  this.$route.query.token\r\n\t\t\t}\r\n\t\t\tlet url = \"/auth/resendotp\";\r\n\t\t\ttry{\r\n\t\t\t\tawait this.$api.post(url, formData);\r\n\t\t\t\tthis.canResend = false;\r\n\t\t\t\tthis.startCountDown();\r\n\t\t\t\tthis.$q.notify({message: \"OTP Sent Successfully\", type: 'positive'});\r\n\t\t\t}\r\n\t\t\tcatch(request){\r\n\t\t\t\tthis.errorMsg = request?.response?.data || \"Unable to resend otp\";\r\n\t\t\t}\r\n\t\t\tfinally{\r\n\t\t\t\tthis.resending = false;\r\n\t\t\t}\r\n        },\r\n\t\tstartCountDown(){\r\n\t\t\tlet duration = parseInt(this.$route.query.duration) || 5; // in minutes\r\n\t\t\tlet minutes = 60 * duration;\r\n\t\t\tlet timer = minutes;\r\n\t\t\tlet seconds;\r\n\t\t\tvar self = this;\r\n\t\t\tconst interval = setInterval(function () {\r\n\t\t\t\tminutes = parseInt(timer / 60, 10);\r\n\t\t\t\tseconds = parseInt(timer % 60, 10);\r\n\t\t\t\tminutes = minutes < 10 ? \"0\" + minutes : minutes;\r\n\t\t\t\tseconds = seconds < 10 ? \"0\" + seconds : seconds;\r\n\t\t\t\tself.countDown = minutes + \":\" + seconds;\r\n\t\t\t\tif (--timer < 0) {\r\n\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t\tself.errorMsg = \"OTP has expired\";\r\n\t\t\t\t\tself.canResend = true;\r\n\t\t\t\t}\r\n\t\t\t}, 1000);\r\n\t\t}\r\n    },\r\n\tmounted() {\r\n    \tthis.startCountDown();\r\n\t},\r\n};\r\n</script>\r\n<style>\r\n\t.otp-input{\r\n\t\tfont-weight: bold;\r\n\t\tfont-size: 20px;\r\n\t\ttext-align: center;\r\n\t\tletter-spacing: 10px;\r\n\t}\r\n\t.otp-input::placeholder{\r\n\t\tfont-weight: normal;\r\n\t\tfont-size: 14px;\r\n\t\ttext-align: center;\r\n\t\tletter-spacing: 1px;\r\n\t}\r\n</style>\r\n"],"names":[],"sourceRoot":""}